"use strict";(()=>{var e={};e.id=978,e.ids=[978],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1440:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>b,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>u,staticGenerationAsyncStorage:()=>d});var a={};r.r(a),r.d(a,{POST:()=>s});var o=r(3277),i=r(5265),l=r(5356),n=r(7076);async function s(e){try{let{amount:t,reference:r,email:a,name:o,phone:i}=await e.json(),l=process.env.NEXT_PUBLIC_TOYYIBPAY_API_KEY,s=process.env.NEXT_PUBLIC_TOYYIBPAY_CATEGORY_CODE||"0",p=`${process.env.NEXT_PUBLIC_APP_URL}/api/toyyibpay/webhook`;if(!l)return n.NextResponse.json({error:"ToyyibPay API key not configured"},{status:400});let c=await fetch("https://api.toyyibpay.com/api/bill/create",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({userSecretKey:l,categoryCode:s,billName:"Rydstore Purchase",billDescription:`Order #${r}`,billPriceSetting:"1",billPayorInfo:"1",billAmount:(100*t).toString(),billReturnUrl:`${process.env.NEXT_PUBLIC_APP_URL}/payment/callback?reference=${r}`,billCallbackUrl:p,billExpiryDate:new Date(Date.now()+864e5).toISOString().split("T")[0],billContentEmail:a,billContentPhone:i}).toString()}),d=await c.json();if(200!==d.status||!d.data.billCode)return n.NextResponse.json({error:"Failed to create bill",details:d},{status:400});{let e={id:r,amount:t,email:a,name:o,phone:i,status:"pending",paymentMethod:"toyyibpay",billCode:d.data.billCode,createdAt:new Date().toISOString()};return n.NextResponse.json({success:!0,billCode:d.data.billCode,billUrl:d.data.billExternalUrl,order:e})}}catch(e){return console.error("ToyyibPay bill creation error:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/toyyibpay/create-bill/route",pathname:"/api/toyyibpay/create-bill",filename:"route",bundlePath:"app/api/toyyibpay/create-bill/route"},resolvedPagePath:"C:\\Users\\farid\\Downloads\\FARID WEBSITE\\GITHUB-UPLOAD\\src\\app\\api\\toyyibpay\\create-bill\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:u}=p,y="/api/toyyibpay/create-bill/route";function b(){return(0,l.patchFetch)({serverHooks:u,staticGenerationAsyncStorage:d})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[942,786],()=>r(1440));module.exports=a})();